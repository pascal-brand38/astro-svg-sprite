"use strict";var B="astro-svg-sprite";import $ from"node:fs";function k(e){const t="./src/assets/images/sprite";if(!e||e==="")return t;if(typeof e=="string")return e;if(Array.isArray(e)){const s=e.filter(r=>r&&r!=="");if(s.length>0)return s}return t}function V(e){return!e||e===""?"assets/images":e}var E=class{colors={reset:"\x1B[0m",fg:{red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",cyanBold:"\x1B[1m\x1B[36m"}};packageName;constructor(e){this.packageName=e}log(e,t=""){const s=e.join(`
`),r=new Date,n=r.getHours().toString().padStart(2,"0"),a=r.getMinutes().toString().padStart(2,"0"),i=r.getSeconds().toString().padStart(2,"0"),c=`\x1B[2m${n}:${a}:${i}\x1B[22m`;console.log(`${c} %s[${this.packageName}]%s ${s}`,t,t?this.colors.reset:"")}info(...e){this.log(e,this.colors.fg.cyanBold)}success(...e){this.log(e,this.colors.fg.cyanBold)}warn(...e){this.log([`${this.colors.fg.yellow}(!)${this.colors.reset} ${e}`],this.colors.fg.cyanBold)}error(...e){this.log([`${this.colors.fg.red}failed!${this.colors.reset}`,...e],this.colors.fg.cyanBold)}};function O(e){const t=/viewBox="([^"]*)"/,s=/fill="([^"]*)"/,r=e.match(t),n=e.match(s),a=r&&r[0]?r[0]:"",i=n&&n[0]?n[0]:"";return`${a} ${i}`}function z(e){const t="<svg",s="</svg>",r=e.indexOf(t),n=e.indexOf(s);if(r!==-1&&n!==-1){const a=e.indexOf(">",r);return e.slice(a+1,n).trim()}return""}function A(e){return typeof e=="string"?$.readdirSync(e).some(s=>s.endsWith(".svg")):Array.isArray(e)?e.some(t=>$.readdirSync(t).some(r=>r.endsWith(".svg"))):!1}function N(e){return e.includes("<svg")&&e.includes("</svg>")}function T(e){const t=performance.now();e();const s=performance.now();return Math.floor(s-t)}var S=new E(B),w=[],b=[],x=[];function F(e){$.readdirSync(e).forEach(t=>{if(!t.toLowerCase().endsWith(".svg"))return;const s=$.readFileSync(`${e}/${t}`,"utf-8");N(s)?x.push(`${e}/${t}`):(b.push(`${e}/${t}`),x.push(`${e}/${t}`)),N(s)&&w.push({name:t.replace(/\.svg$/,""),content:s})})}function P(e){typeof e=="string"?F(e):Array.isArray(e)&&e.forEach(t=>F(t))}function C(e){return A(e)&&(typeof e=="string"?P(e):Array.isArray(e)&&e.forEach(t=>P(t))),w}function I(e){let t='<svg xmlns="http://www.w3.org/2000/svg" class="svg-sprite">';return e.forEach(s=>{t+=`
      <symbol class="svg-sprite" id="${s.name}" ${O(s.content)}>
        ${z(s.content)}  
      </symbol>
    `}),t+="</svg>",t}function D(e,t){if(!$.existsSync(e)){const s=e.substr(0,e.lastIndexOf("/"));$.existsSync(s)||$.mkdirSync(s,{recursive:!0}),$.writeFileSync(e,"","utf-8")}$.writeFileSync(e,t,"utf-8")}function G(e){const t=/<circle([^>]*)\/?>/g;return e.replace(t,(r,n)=>{const a=/(\w+)\s*=\s*["']([^"']*)["']/g,i={};let c;for(;(c=a.exec(n))!==null;){const[,d,p]=c;i[d]=p}const{cx:l,cy:u,r:o,...g}=i,m=`M${Number(l)-Number(o)},${u}A${o},${o} 0 1,0 ${Number(l)+Number(o)},${u}A${o},${o} 0 1,0 ${Number(l)-Number(o)},${u}`,f=Object.entries(g).map(([d,p])=>`${d}="${p}"`).join(" ");return`<path d="${m}" ${f}></path>`})}function L(e){const t=/<ellipse([^>]*)\/?>/g;return e.replace(t,(r,n)=>{const a=/(\w+)\s*=\s*["']([^"']*)["']/g,i={};let c;for(;(c=a.exec(n))!==null;){const[,p,h]=c;i[p]=h}const{cx:l,cy:u,rx:o,ry:g,...m}=i,f=`M${Number(l)-Number(o)},${u}A${o},${g} 0 1,0 ${Number(l)+Number(o)},${u}A${o},${g} 0 1,0 ${Number(l)-Number(o)},${u}`,d=Object.entries(m).map(([p,h])=>`${p}="${h}"`).join(" ");return`<path d="${f}" ${d}></path>`})}function W(e){const t=/<line([^>]*)\/?>/g;return e.replace(t,(r,n)=>{const a=/(\w+)\s*=\s*["']([^"']*)["']/g,i={};let c;for(;(c=a.exec(n))!==null;){const[,p,h]=c;i[p]=h}const{x1:l,y1:u,x2:o,y2:g,...m}=i,f=`M ${l},${u} L ${o},${g}`,d=Object.entries(m).map(([p,h])=>`${p}="${h}"`).join(" ");return`<path d="${f}" ${d}></path>`})}function M(e){return e.split(/\s+/).map(t=>Number(t))}function Z(e){const t=/<polygon([^>]*)\/?>/g;return e.replace(t,(r,n)=>{const a=/(\w+)\s*=\s*["']([^"']*)["']/g,i={};let c;for(;(c=a.exec(n))!==null;){const[,m,f]=c;i[m]=f}const{points:l,...u}=i,o=`M ${M(l).join(" ")} Z`,g=Object.entries(u).map(([m,f])=>`${m}="${f}"`).join(" ");return`<path d="${o}" ${g}></path>`})}function H(e){const t=/<polyline([^>]*)\/?>/g;return e.replace(t,(r,n)=>{const a=/(\w+)\s*=\s*["']([^"']*)["']/g,i={};let c;for(;(c=a.exec(n))!==null;){const[,m,f]=c;i[m]=f}const{points:l,...u}=i,o=`M ${M(l).join(" ")}`,g=Object.entries(u).map(([m,f])=>`${m}="${f}"`).join(" ");return`<path d="${o}" ${g}></path>`})}function _(e){return e=G(e),e=L(e),e=W(e),e=Z(e),e=H(e),e}function q(e){const t=["g","defs","metadata","title","desc","marker"];for(const s of t){const r=new RegExp(`<${s}\\b[^>]*>`,"g"),n=new RegExp(`</${s}\\s*>`,"g");e=e.replace(r,""),e=e.replace(n,"")}return e}function R(e){return e.replace(/>\s+</g,"><").replace(/\s+(?==|>)/g,"").replace(/(\r\n|\n|\r|\t)/g,"")}function j(e){return e=R(e),e=q(e),e.replace(/<(\w+)><\/\1>/g,"").replace(/"/g,"'").replace(/([a-zA-Z-]+)\s*=\s*([a-zA-Z0-9-]+)/g,"$1=$2").replace(/style="([^"]+)"/g,(t,s)=>`style="${s.replace(/(\r\n|\n|\r|\t)/gm,"").replace(/ +/g," ")}"`)}function J(e){return e=j(e),e=_(e),e}function K(e,t){switch(t){case"best":e=J(e);break;case"standard":case void 0:e=j(e);break;case"fast":e=R(e);break;default:break}return e}function v(e){return e.length===1?"file":"files"}function U(){if(b.length>0){console.log(`
\x1B[42m parsed ${x.length} SVG ${v(x)} \x1B[0m`);const e=[`
\x1B[33m(!) Please provide a standard svg ${v(b)}.`,`\x1B[1m${v(b)}:\x1B[22m ${JSON.stringify(b,null,2)}`,`   \x1B[1mNot a valid SVG file.\x1B[22m
`,`\x1B[33m- To remove the warning information, delete or remove the SVG ${v(b)}.`,`- Visit \x1B[4mhttps://developer.mozilla.org/en-US/docs/Web/SVG\x1B[24m know more about SVG.\x1B[0m
`];console.log(`${e.join(`
`)}`)}}function Q(e,t){$.stat(e,(s,r)=>{if(s){S.error("Could not read file information:",`${s}`);return}const a=r.size/1024;S.info(`\x1B[2mCompleted in ${y}ms.\x1B[22m`),U(),S.success(`\x1B[32mgenerated\x1B[0m 'sprite.svg' ${a}(kb).`)})}async function X(e,t){let s;return t?s=`${e.replaceAll(`
`,"")}`:s=`

<!--astro-svg-sprite-->
${e.replace(/(?<!\n)\n\n+(?!\n)/g,`
`)}
<!--astro-svg-sprite-->
	`,{name:"vite-plugin-spriter",enforce:"pre",transform(r){try{return r.replace("</body>",`${s}</body>`)}catch(n){throw n}}}}var Y={emitFile:!0},ee={include:"./src/assets/images/sprite",mode:"verbose",emitFile:{compress:"standard",path:"assets/images"},...Y},y;function te(e={}){var t,s;let r,n;const a={...ee,...e},i=k(e.include),c=V((t=e.emitFile)==null?void 0:t.path),l=C(i),u=K(I(l),(s=a.emitFile)==null?void 0:s.compress);function o(){A(i)&&(e.emitFile||a.emitFile)&&(l.length!==0&&D(r,u),a.mode!=="quiet"&&Q(r,c))}return{name:B,hooks:{"astro:config:setup":async({updateConfig:g,config:m})=>{(e?.emitFile!==void 0||e?.emitFile===!1)&&g({vite:{plugins:[X(u,m.compressHTML)]}})},"astro:config:done":async({config:g})=>{n=g,r=`${n.publicDir.pathname}${c}/sprite.svg`},"astro:server:start":async()=>{y=T(o)},"astro:build:start":async()=>{y=T(o)}}}}export{te as default,y as executionTime};
